<form action="/api/upload/zip" method="post" enctype="multipart/form-data">
    <input type="file" name="upload"/> {% csrf_token %}
    <input type="submit" value="Upload Zip"/>
</form>
<br>
<form action="/api/source/source_filename" method="post" enctype="multipart/form-data">
    <input type="file" name="upload"/> {% csrf_token %}
    <input type="submit" value="Upload Source (.tr)"/>
</form>

{% if lasttake %}
<a href="/api/languages">Languages</a> <br><br>
<a href="/api/books">Books</a> <br><br>
<a href="/api/takes">Takes</a> <br><br>
<a href="/api/users">Users</a> <br><br>
<a href="/api/comments">Comments</a> <br><br>
<a href="/api/get_project">Get Project</a> <br><br><br>
<a href="/api/zipFiles">Zip Files</a> <br><br><br>
<a href="/api/upload/zip">Upload zip</a> <br><br>
<a href="/api/all_project">Show Project</a> <br><br>
<a href="/api/get_chapters">Show Chapters</a><br><br>

<div>
    <div>{{ lasttake }}</div>
    <audio controls>
        <source src="/api/stream/{{ lasttake.location }}" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>
</div>
<div>
    <button id="getsource">Get Source</button>
</div>
<div>
    <button id="getzip">Get zip</button>
</div>
{% endif %}

<script>
    document.getElementById("getsource").addEventListener("click", function(event) {
        jspost("/api/get_source/", {
            "language": "en-x-demo2",
            "version": "ulb",
        })
    }, false);
  document.getElementById("getzip").addEventListener("click", function(event) {
        jspost("/api/push_comments_takes/", {
            "project":{"language": "en-x-demo2",
            "version": "ulb",
            "book":"mrk"},
            "files_list":{}
        })
    }, false);
    function jspost(url, data) {
        var xmlhttp = new XMLHttpRequest(); // new HttpRequest instance
        xmlhttp.open("POST", url);
        xmlhttp.responseType="blob"
        xmlhttp.setRequestHeader("Content-Type", "application/json");
        xmlhttp.send(JSON.stringify(data));
        xmlhttp.onreadystatechange=function(){
        console.log(xmlhttp.responseType)
        if(xmlhttp.readyState==XMLHttpRequest.DONE){
        var blob=xmlhttp.response
        saveAs(blob,'file.zip')
        }}
    }
















</script>
<script src="/media/FileSaver.min.js"></script>